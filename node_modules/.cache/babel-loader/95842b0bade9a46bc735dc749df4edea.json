{"remainingRequest":"/home/ubuntu/workspace/web/node_modules/thread-loader/dist/cjs.js!/home/ubuntu/workspace/web/node_modules/babel-loader/lib/index.js!/home/ubuntu/workspace/web/src/permission.js","dependencies":[{"path":"/home/ubuntu/workspace/web/src/permission.js","mtime":1646407314000},{"path":"/home/ubuntu/workspace/web/babel.config.js","mtime":1646407314000},{"path":"/home/ubuntu/workspace/web/node_modules/cache-loader/dist/cjs.js","mtime":1725533577608},{"path":"/home/ubuntu/workspace/web/node_modules/thread-loader/dist/cjs.js","mtime":1725533577605},{"path":"/home/ubuntu/workspace/web/node_modules/babel-loader/lib/index.js","mtime":1725533578244}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9vYmplY3RTcHJlYWQgZnJvbSAiL2hvbWUvdWJ1bnR1L3dvcmtzcGFjZS93ZWIvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL29iamVjdFNwcmVhZDIuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5pbmNsdWRlcy5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5Lm1hcC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLm9iamVjdC50by1zdHJpbmcuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5zdHJpbmcuaXRlcmF0b3IuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy93ZWIuZG9tLWNvbGxlY3Rpb25zLml0ZXJhdG9yLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuY29uY2F0LmpzIjsKaW1wb3J0IFZ1ZSBmcm9tICd2dWUnOwppbXBvcnQgcm91dGVyIGZyb20gJy4vcm91dGVyL3JvdXRlcic7CmltcG9ydCBzdG9yZSBmcm9tICcuL3N0b3JlL3Z1ZXgnOwppbXBvcnQgeyBnZXRBY3Rpb24gfSBmcm9tICdAL3JlcXVlc3QvaHR0cC5qcyc7CnZhciB3aGl0ZUxpc3QgPSBbJy9sb2dpbiddOwpyb3V0ZXIuYmVmb3JlRWFjaChmdW5jdGlvbiAodG8sIGZyb20sIG5leHQpIHsKICAvLyDojrflj5Z0b2tlbgogIHZhciB0b2tlbiA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCd0b2tlbicpOyAvLyDlrZjlnKh0b2tlbiDmiJbogIUg5Zyo55m95ZCN5Y2V5LitCgogIGlmICh0b2tlbiB8fCB3aGl0ZUxpc3QuaW5jbHVkZXModG8ucGF0aCkpIHsKICAgIGlmICh0b2tlbiAmJiB0by5wYXRoID09ICcvbG9naW4nKSB7CiAgICAgIG5leHQoJy8nKTsKICAgIH0gZWxzZSBpZiAodG9rZW4pIHsKICAgICAgLy8g5LiN5a2Y5Zyo5p2D6ZmQ5L+h5oGvCiAgICAgIGlmICghc3RvcmUuc3RhdGUucGVybWlzc2lvbikgewogICAgICAgIC8vIGxldCB1c2VybmFtZSA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCd1c2VybmFtZScpCiAgICAgICAgLy8gZ2V0QWN0aW9uKGBtZW51LyR7dXNlcm5hbWV9YCx7fSkudGhlbihyZXM9PnsKICAgICAgICAvLyAgIGlmKHJlcy5jb2RlID09IDApewogICAgICAgIHZhciByZXMgPSBbewogICAgICAgICAga2V5OiAiIiwKICAgICAgICAgIG5hbWU6ICIiCiAgICAgICAgfV07CiAgICAgICAgdmFyIHBlcm1pc3Npb24gPSByZXM7CiAgICAgICAgdmFyIG5ld19wZXJtaXNzaW9uID0gcGVybWlzc2lvbi5tYXAoZnVuY3Rpb24gKGVsZSkgewogICAgICAgICAgdmFyIHBhdGhPYmogPSB7fTsKICAgICAgICAgIHBhdGhPYmoucGF0aCA9ICcvJyArIGVsZS5wYXRoOwoKICAgICAgICAgIHBhdGhPYmouY29tcG9uZW50ID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgICByZXR1cm4gaW1wb3J0KCJAL3ZpZXcvIi5jb25jYXQoZWxlLnBhdGgsICIvIikuY29uY2F0KGVsZS5wYXRoKSk7CiAgICAgICAgICB9OwoKICAgICAgICAgIHJldHVybiBwYXRoT2JqOwogICAgICAgIH0pOyAvLyDmt7vliqDot6/nlLEKCiAgICAgICAgcm91dGVyLmFkZFJvdXRlcyhuZXdfcGVybWlzc2lvbik7IC8vIOWwhuaVsOaNrui1i+WAvOe7mXN0b3JlICDnlKjmnaXmuLLmn5PkvqfovrnmoI8KCiAgICAgICAgc3RvcmUuY29tbWl0KCdhZGRwZXJtaXNzaW9uJywgcGVybWlzc2lvbik7CiAgICAgICAgbmV4dChfb2JqZWN0U3ByZWFkKF9vYmplY3RTcHJlYWQoe30sIHRvKSwge30sIHsKICAgICAgICAgIHJlcGxhY2U6IHRydWUKICAgICAgICB9KSk7IC8vICAgfQogICAgICAgIC8vIH0pICAgIAogICAgICB9IC8vIOi/m+ihjOi3s+i9rAoKCiAgICAgIG5leHQoKTsKICAgIH0gZWxzZSB7CiAgICAgIG5leHQoKTsKICAgIH0KICB9IGVsc2UgewogICAgLy8g5Lik6ICF6YO95LiN5ruh6LazIOi/lOWbnueZu+W9lemhtQogICAgbmV4dCgnL2xvZ2luJyk7CiAgfQp9KTs="},{"version":3,"sources":["/home/ubuntu/workspace/web/src/permission.js"],"names":["Vue","router","store","getAction","whiteList","beforeEach","to","from","next","token","localStorage","getItem","includes","path","state","permission","res","key","name","new_permission","map","ele","pathObj","component","addRoutes","commit","replace"],"mappings":";;;;;;;AAAA,OAAOA,GAAP,MAAgB,KAAhB;AACA,OAAOC,MAAP,MAAmB,iBAAnB;AACA,OAAOC,KAAP,MAAkB,cAAlB;AACA,SAAQC,SAAR,QAAwB,mBAAxB;AACA,IAAMC,SAAS,GAAG,CAAC,QAAD,CAAlB;AACAH,MAAM,CAACI,UAAP,CAAkB,UAACC,EAAD,EAAIC,IAAJ,EAASC,IAAT,EAAgB;AAChC;AACA,MAAIC,KAAK,GAAGC,YAAY,CAACC,OAAb,CAAqB,OAArB,CAAZ,CAFgC,CAGhC;;AACA,MAAGF,KAAK,IAAIL,SAAS,CAACQ,QAAV,CAAmBN,EAAE,CAACO,IAAtB,CAAZ,EAAwC;AACtC,QAAGJ,KAAK,IAAIH,EAAE,CAACO,IAAH,IAAW,QAAvB,EAAgC;AAC9BL,MAAAA,IAAI,CAAC,GAAD,CAAJ;AACD,KAFD,MAEM,IAAGC,KAAH,EAAS;AACb;AACA,UAAG,CAACP,KAAK,CAACY,KAAN,CAAYC,UAAhB,EAA2B;AACzB;AACA;AACA;AACA,YAAIC,GAAG,GAAG,CACR;AACEC,UAAAA,GAAG,EAAC,EADN;AAEEC,UAAAA,IAAI,EAAC;AAFP,SADQ,CAAV;AAMA,YAAIH,UAAU,GAAGC,GAAjB;AACA,YAAIG,cAAc,GAAGJ,UAAU,CAACK,GAAX,CAAe,UAAAC,GAAG,EAAE;AACvC,cAAIC,OAAO,GAAG,EAAd;AACAA,UAAAA,OAAO,CAACT,IAAR,GAAe,MAAMQ,GAAG,CAACR,IAAzB;;AACAS,UAAAA,OAAO,CAACC,SAAR,GAAoB;AAAA,mBAAM,wBAAiBF,GAAG,CAACR,IAArB,cAA6BQ,GAAG,CAACR,IAAjC,EAAN;AAAA,WAApB;;AACA,iBAAOS,OAAP;AACD,SALoB,CAArB,CAXyB,CAiBrB;;AACJrB,QAAAA,MAAM,CAACuB,SAAP,CAAiBL,cAAjB,EAlByB,CAmBzB;;AACAjB,QAAAA,KAAK,CAACuB,MAAN,CAAa,eAAb,EAA6BV,UAA7B;AACAP,QAAAA,IAAI,iCAAMF,EAAN;AAAUoB,UAAAA,OAAO,EAAE;AAAnB,WAAJ,CArByB,CAsBzB;AACA;AACD,OA1BY,CA2Bb;;;AACAlB,MAAAA,IAAI;AACL,KA7BK,MA6BD;AACHA,MAAAA,IAAI;AACL;AACF,GAnCD,MAmCK;AACH;AACAA,IAAAA,IAAI,CAAC,QAAD,CAAJ;AACD;AACF,CA3CD","sourcesContent":["import Vue from 'vue'\r\nimport router from './router/router'\r\nimport store from './store/vuex'\r\nimport {getAction} from '@/request/http.js'\r\nconst whiteList = ['/login']\r\nrouter.beforeEach((to,from,next)=>{\r\n  // 获取token\r\n  var token = localStorage.getItem('token');\r\n  // 存在token 或者 在白名单中\r\n  if(token || whiteList.includes(to.path)){\r\n    if(token && to.path == '/login'){\r\n      next('/')\r\n    }else if(token){\r\n      // 不存在权限信息\r\n      if(!store.state.permission){\r\n        // let username = localStorage.getItem('username')\r\n        // getAction(`menu/${username}`,{}).then(res=>{\r\n        //   if(res.code == 0){\r\n        let res = [\r\n          {\r\n            key:\"\",\r\n            name:\"\"\r\n          }\r\n        ]\r\n        let permission = res;\r\n        let new_permission = permission.map(ele=>{\r\n          let pathObj = {}\r\n          pathObj.path = '/' + ele.path\r\n          pathObj.component = () => import(`@/view/${ele.path}/${ele.path}`)\r\n          return pathObj\r\n        });\r\n            // 添加路由\r\n        router.addRoutes(new_permission)\r\n        // 将数据赋值给store  用来渲染侧边栏\r\n        store.commit('addpermission',permission);\r\n        next({ ...to, replace: true })\r\n        //   }\r\n        // })    \r\n      }\r\n      // 进行跳转\r\n      next()\r\n    }else{\r\n      next()\r\n    }\r\n  }else{\r\n    // 两者都不满足 返回登录页\r\n    next('/login')\r\n  }\r\n})"]}]}